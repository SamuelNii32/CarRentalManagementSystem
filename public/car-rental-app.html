<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Car Rentals Management Dashboard</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
      body {
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background-color: #f5f5f5;
      }

      .app {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      .nav {
        background: white;
        border-radius: 8px;
        padding: 15px 20px;
        margin-bottom: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        display: flex;
        gap: 20px;
        align-items: center;
      }

      .nav h1 {
        margin: 0;
        color: #333;
        font-size: 24px;
      }

      .nav-links {
        display: flex;
        gap: 15px;
        margin-left: auto;
      }

      .nav-btn {
        background: none;
        border: none;
        padding: 8px 16px;
        border-radius: 5px;
        cursor: pointer;
        color: #666;
        font-weight: 500;
      }

      .nav-btn.active {
        background: #007bff;
        color: white;
      }

      .nav-btn:hover {
        background: #e9ecef;
      }

      .nav-btn.active:hover {
        background: #0056b3;
      }

      .dashboard {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .stat-card {
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .stat-icon {
        width: 50px;
        height: 50px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        color: white;
      }

      .stat-icon.blue { background: #007bff; }
      .stat-icon.green { background: #28a745; }
      .stat-icon.orange { background: #fd7e14; }
      .stat-icon.purple { background: #6f42c1; }

      .stat-content h3 {
        margin: 0;
        font-size: 28px;
        font-weight: 700;
        color: #333;
      }

      .stat-content p {
        margin: 5px 0 0 0;
        color: #666;
        font-size: 14px;
      }

      .section {
        background: white;
        border-radius: 8px;
        padding: 25px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }

      .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        border-bottom: 1px solid #eee;
        padding-bottom: 15px;
      }

      .section-title {
        margin: 0;
        color: #333;
        font-size: 20px;
      }

      .btn {
        background: #007bff;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        text-decoration: none;
      }

      .btn:hover {
        background: #0056b3;
      }

      .btn-outline {
        background: transparent;
        color: #007bff;
        border: 1px solid #007bff;
      }

      .btn-outline:hover {
        background: #007bff;
        color: white;
      }

      .btn-danger {
        background: #dc3545;
      }

      .btn-danger:hover {
        background: #c82333;
      }

      .btn-sm {
        padding: 6px 12px;
        font-size: 12px;
      }

      .grid {
        display: grid;
        gap: 20px;
      }

      .grid-2 {
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      }

      .grid-3 {
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      }

      .card {
        border: 1px solid #eee;
        border-radius: 8px;
        overflow: hidden;
        background: white;
      }

      .card-header {
        padding: 15px 20px;
        background: #f8f9fa;
        border-bottom: 1px solid #eee;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .card-body {
        padding: 20px;
      }

      .card-actions {
        display: flex;
        gap: 8px;
        margin-top: 15px;
      }

      .vehicle-image {
        width: 100%;
        height: 200px;
        object-fit: cover;
        background: #f8f9fa;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #666;
        font-size: 48px;
      }

      .badge {
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: 500;
        color: white;
      }

      .badge-available { background: #28a745; }
      .badge-rented { background: #dc3545; }
      .badge-vip { background: #6f42c1; }
      .badge-active { background: #007bff; }
      .badge-new { background: #28a745; }
      .badge-confirmed { background: #007bff; }
      .badge-overdue { background: #dc3545; }
      .badge-completed { background: #6c757d; }

      .detail-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 10px;
        margin: 15px 0;
      }

      .detail-item {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }

      .detail-label {
        font-size: 12px;
        color: #666;
        font-weight: 500;
      }

      .detail-value {
        font-size: 14px;
        color: #333;
        font-weight: 600;
      }

      .price {
        color: #28a745;
        font-weight: 700;
        font-size: 18px;
      }

      .loading {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 40px;
        color: #666;
      }

      .error {
        color: #dc3545;
        text-align: center;
        padding: 40px;
        background: #f8d7da;
        border-radius: 5px;
        margin: 20px 0;
      }

      .refresh-btn {
        background: #17a2b8;
        margin-left: 10px;
      }

      .refresh-btn:hover {
        background: #138496;
      }

      /* Modal Styles */
      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.5);
      }

      .modal.show {
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .modal-content {
        background-color: white;
        padding: 0;
        border-radius: 8px;
        width: 90%;
        max-width: 500px;
        max-height: 90vh;
        overflow-y: auto;
      }

      .modal-header {
        padding: 20px;
        border-bottom: 1px solid #eee;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .modal-title {
        margin: 0;
        font-size: 18px;
        color: #333;
      }

      .close {
        background: none;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: #999;
      }

      .close:hover {
        color: #333;
      }

      .modal-body {
        padding: 20px;
      }

      .form-group {
        margin-bottom: 20px;
      }

      .form-label {
        display: block;
        margin-bottom: 5px;
        font-weight: 500;
        color: #333;
      }

      .form-control {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 14px;
        box-sizing: border-box;
      }

      .form-control:focus {
        outline: none;
        border-color: #007bff;
        box-shadow: 0 0 0 3px rgba(0,123,255,0.1);
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
      }

      .modal-footer {
        padding: 20px;
        border-top: 1px solid #eee;
        display: flex;
        justify-content: flex-end;
        gap: 10px;
      }

      .btn-secondary {
        background: #6c757d;
        color: white;
      }

      .btn-secondary:hover {
        background: #545b62;
      }

      @media (max-width: 768px) {
        .app {
          padding: 10px;
        }
        
        .nav {
          flex-direction: column;
          gap: 10px;
        }
        
        .nav-links {
          margin-left: 0;
        }
        
        .dashboard {
          grid-template-columns: 1fr;
        }
        
        .form-row {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect } = React;

      const API_BASE = window.location.origin + "/admin";

      // Modal component for forms
      function Modal({ show, onClose, title, children }) {
        if (!show) return null;

        return (
          <div className="modal show">
            <div className="modal-content">
              <div className="modal-header">
                <h3 className="modal-title">{title}</h3>
                <button className="close" onClick={onClose}>&times;</button>
              </div>
              {children}
            </div>
          </div>
        );
      }

      // Vehicle Form Component
      function VehicleForm({ vehicle, onSave, onCancel }) {
        const [formData, setFormData] = useState(vehicle || {
          name: '',
          year: '',
          registrationNumber: '',
          type: '',
          fuel: '',
          seats: '',
          pricePerDay: '',
          available: true
        });

        const handleSubmit = async (e) => {
          e.preventDefault();
          const url = vehicle ? `${API_BASE}/vehicle/${vehicle._id}` : `${API_BASE}/vehicle`;
          const method = vehicle ? 'PUT' : 'POST';

          try {
            const response = await fetch(url, {
              method,
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(formData)
            });

            if (response.ok) {
              onSave();
            } else {
              alert('Error saving vehicle');
            }
          } catch (error) {
            alert('Error saving vehicle');
          }
        };

        return (
          <>
            <div className="modal-body">
              <form onSubmit={handleSubmit}>
                <div className="form-group">
                  <label className="form-label">Vehicle Name</label>
                  <input
                    type="text"
                    className="form-control"
                    value={formData.name}
                    onChange={(e) => setFormData({...formData, name: e.target.value})}
                    required
                  />
                </div>
                <div className="form-row">
                  <div className="form-group">
                    <label className="form-label">Year</label>
                    <input
                      type="number"
                      className="form-control"
                      value={formData.year}
                      onChange={(e) => setFormData({...formData, year: e.target.value})}
                      required
                    />
                  </div>
                  <div className="form-group">
                    <label className="form-label">Registration Number</label>
                    <input
                      type="text"
                      className="form-control"
                      value={formData.registrationNumber}
                      onChange={(e) => setFormData({...formData, registrationNumber: e.target.value})}
                      required
                    />
                  </div>
                </div>
                <div className="form-row">
                  <div className="form-group">
                    <label className="form-label">Type</label>
                    <select
                      className="form-control"
                      value={formData.type}
                      onChange={(e) => setFormData({...formData, type: e.target.value})}
                      required
                    >
                      <option value="">Select Type</option>
                      <option value="Sedan">Sedan</option>
                      <option value="SUV">SUV</option>
                      <option value="Hatchback">Hatchback</option>
                      <option value="Truck">Truck</option>
                      <option value="Coupe">Coupe</option>
                    </select>
                  </div>
                  <div className="form-group">
                    <label className="form-label">Fuel Type</label>
                    <select
                      className="form-control"
                      value={formData.fuel}
                      onChange={(e) => setFormData({...formData, fuel: e.target.value})}
                      required
                    >
                      <option value="">Select Fuel</option>
                      <option value="Petrol">Petrol</option>
                      <option value="Diesel">Diesel</option>
                      <option value="Electric">Electric</option>
                      <option value="Hybrid">Hybrid</option>
                    </select>
                  </div>
                </div>
                <div className="form-row">
                  <div className="form-group">
                    <label className="form-label">Seats</label>
                    <input
                      type="number"
                      className="form-control"
                      value={formData.seats}
                      onChange={(e) => setFormData({...formData, seats: e.target.value})}
                      required
                    />
                  </div>
                  <div className="form-group">
                    <label className="form-label">Price Per Day ($)</label>
                    <input
                      type="number"
                      step="0.01"
                      className="form-control"
                      value={formData.pricePerDay}
                      onChange={(e) => setFormData({...formData, pricePerDay: e.target.value})}
                      required
                    />
                  </div>
                </div>
                <div className="form-group">
                  <label className="form-label">
                    <input
                      type="checkbox"
                      checked={formData.available}
                      onChange={(e) => setFormData({...formData, available: e.target.checked})}
                    />
                    {' '}Available for Rent
                  </label>
                </div>
              </form>
            </div>
            <div className="modal-footer">
              <button type="button" className="btn btn-secondary" onClick={onCancel}>
                Cancel
              </button>
              <button type="submit" className="btn" onClick={handleSubmit}>
                {vehicle ? 'Update' : 'Create'} Vehicle
              </button>
            </div>
          </>
        );
      }

      // Customer Form Component
      function CustomerForm({ customer, onSave, onCancel }) {
        const [formData, setFormData] = useState(customer || {
          name: '',
          email: '',
          phone: '',
          address: '',
          status: 'Active',
          rating: 5
        });

        const handleSubmit = async (e) => {
          e.preventDefault();
          const url = customer ? `${API_BASE}/customers/${customer._id}` : `${API_BASE}/customers`;
          const method = customer ? 'PUT' : 'POST';

          try {
            const response = await fetch(url, {
              method,
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(formData)
            });

            if (response.ok) {
              onSave();
            } else {
              alert('Error saving customer');
            }
          } catch (error) {
            alert('Error saving customer');
          }
        };

        return (
          <>
            <div className="modal-body">
              <form onSubmit={handleSubmit}>
                <div className="form-group">
                  <label className="form-label">Full Name</label>
                  <input
                    type="text"
                    className="form-control"
                    value={formData.name}
                    onChange={(e) => setFormData({...formData, name: e.target.value})}
                    required
                  />
                </div>
                <div className="form-row">
                  <div className="form-group">
                    <label className="form-label">Email</label>
                    <input
                      type="email"
                      className="form-control"
                      value={formData.email}
                      onChange={(e) => setFormData({...formData, email: e.target.value})}
                      required
                    />
                  </div>
                  <div className="form-group">
                    <label className="form-label">Phone</label>
                    <input
                      type="tel"
                      className="form-control"
                      value={formData.phone}
                      onChange={(e) => setFormData({...formData, phone: e.target.value})}
                      required
                    />
                  </div>
                </div>
                <div className="form-group">
                  <label className="form-label">Address</label>
                  <textarea
                    className="form-control"
                    rows="3"
                    value={formData.address}
                    onChange={(e) => setFormData({...formData, address: e.target.value})}
                    required
                  />
                </div>
                <div className="form-row">
                  <div className="form-group">
                    <label className="form-label">Status</label>
                    <select
                      className="form-control"
                      value={formData.status}
                      onChange={(e) => setFormData({...formData, status: e.target.value})}
                    >
                      <option value="Active">Active</option>
                      <option value="VIP">VIP</option>
                      <option value="New">New</option>
                    </select>
                  </div>
                  <div className="form-group">
                    <label className="form-label">Rating</label>
                    <select
                      className="form-control"
                      value={formData.rating}
                      onChange={(e) => setFormData({...formData, rating: parseInt(e.target.value)})}
                    >
                      <option value="1">1 Star</option>
                      <option value="2">2 Stars</option>
                      <option value="3">3 Stars</option>
                      <option value="4">4 Stars</option>
                      <option value="5">5 Stars</option>
                    </select>
                  </div>
                </div>
              </form>
            </div>
            <div className="modal-footer">
              <button type="button" className="btn btn-secondary" onClick={onCancel}>
                Cancel
              </button>
              <button type="submit" className="btn" onClick={handleSubmit}>
                {customer ? 'Update' : 'Create'} Customer
              </button>
            </div>
          </>
        );
      }

      // Rental Form Component
      function RentalForm({ rental, vehicles, customers, onSave, onCancel }) {
        const [formData, setFormData] = useState(rental || {
          customerId: '',
          vehicleId: '',
          startDate: '',
          endDate: '',
          dailyRate: ''
        });

        const handleSubmit = async (e) => {
          e.preventDefault();
          
          try {
            const response = await fetch(`${API_BASE}/rentals`, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(formData)
            });

            if (response.ok) {
              onSave();
            } else {
              alert('Error creating rental');
            }
          } catch (error) {
            alert('Error creating rental');
          }
        };

        return (
          <>
            <div className="modal-body">
              <form onSubmit={handleSubmit}>
                <div className="form-row">
                  <div className="form-group">
                    <label className="form-label">Customer</label>
                    <select
                      className="form-control"
                      value={formData.customerId}
                      onChange={(e) => setFormData({...formData, customerId: e.target.value})}
                      required
                    >
                      <option value="">Select Customer</option>
                      {customers.map(customer => (
                        <option key={customer._id} value={customer._id}>
                          {customer.name}
                        </option>
                      ))}
                    </select>
                  </div>
                  <div className="form-group">
                    <label className="form-label">Vehicle</label>
                    <select
                      className="form-control"
                      value={formData.vehicleId}
                      onChange={(e) => {
                        const selectedVehicle = vehicles.find(v => v._id === e.target.value);
                        setFormData({
                          ...formData, 
                          vehicleId: e.target.value,
                          dailyRate: selectedVehicle ? selectedVehicle.pricePerDay : ''
                        });
                      }}
                      required
                    >
                      <option value="">Select Vehicle</option>
                      {vehicles.filter(v => v.available).map(vehicle => (
                        <option key={vehicle._id} value={vehicle._id}>
                          {vehicle.name} ({vehicle.year}) - ${vehicle.pricePerDay}/day
                        </option>
                      ))}
                    </select>
                  </div>
                </div>
                <div className="form-row">
                  <div className="form-group">
                    <label className="form-label">Start Date</label>
                    <input
                      type="date"
                      className="form-control"
                      value={formData.startDate}
                      onChange={(e) => setFormData({...formData, startDate: e.target.value})}
                      required
                    />
                  </div>
                  <div className="form-group">
                    <label className="form-label">End Date</label>
                    <input
                      type="date"
                      className="form-control"
                      value={formData.endDate}
                      onChange={(e) => setFormData({...formData, endDate: e.target.value})}
                      required
                    />
                  </div>
                </div>
                <div className="form-group">
                  <label className="form-label">Daily Rate ($)</label>
                  <input
                    type="number"
                    step="0.01"
                    className="form-control"
                    value={formData.dailyRate}
                    onChange={(e) => setFormData({...formData, dailyRate: e.target.value})}
                    required
                  />
                </div>
              </form>
            </div>
            <div className="modal-footer">
              <button type="button" className="btn btn-secondary" onClick={onCancel}>
                Cancel
              </button>
              <button type="submit" className="btn" onClick={handleSubmit}>
                Create Rental
              </button>
            </div>
          </>
        );
      }

      // Main App Component
      function App() {
        const [activeTab, setActiveTab] = useState('dashboard');
        const [vehicles, setVehicles] = useState([]);
        const [customers, setCustomers] = useState([]);
        const [rentals, setRentals] = useState([]);
        const [loading, setLoading] = useState(true);
        const [error, setError] = useState(null);

        // Modal states
        const [showVehicleModal, setShowVehicleModal] = useState(false);
        const [showCustomerModal, setShowCustomerModal] = useState(false);
        const [showRentalModal, setShowRentalModal] = useState(false);
        const [editingVehicle, setEditingVehicle] = useState(null);
        const [editingCustomer, setEditingCustomer] = useState(null);

        const fetchData = async () => {
          setLoading(true);
          try {
            const [vehiclesRes, customersRes, rentalsRes] = await Promise.all([
              fetch(`${API_BASE}/api/vehicles`),
              fetch(`${API_BASE}/api/customers`),
              fetch(`${API_BASE}/api/rentals`)
            ]);

            const vehiclesData = await vehiclesRes.json();
            const customersData = await customersRes.json();
            const rentalsData = await rentalsRes.json();

            setVehicles(vehiclesData);
            setCustomers(customersData);
            setRentals(rentalsData);
            setError(null);
          } catch (err) {
            setError('Failed to load data. Please check your server connection.');
          } finally {
            setLoading(false);
          }
        };

        useEffect(() => {
          fetchData();
          // Refresh data every 30 seconds
          const interval = setInterval(fetchData, 30000);
          return () => clearInterval(interval);
        }, []);

        const handleDeleteVehicle = async (id) => {
          if (confirm('Are you sure you want to delete this vehicle?')) {
            try {
              const response = await fetch(`${API_BASE}/vehicle/${id}`, {
                method: 'DELETE'
              });

              if (response.ok) {
                fetchData();
              } else {
                const error = await response.text();
                alert(error);
              }
            } catch (error) {
              alert('Error deleting vehicle');
            }
          }
        };

        const handleDeleteCustomer = async (id) => {
          if (confirm('Are you sure you want to delete this customer?')) {
            try {
              const response = await fetch(`${API_BASE}/customers/${id}`, {
                method: 'DELETE'
              });

              if (response.ok) {
                fetchData();
              } else {
                const error = await response.json();
                alert(error.error);
              }
            } catch (error) {
              alert('Error deleting customer');
            }
          }
        };

        // Dashboard calculations
        const totalVehicles = vehicles.length;
        const availableVehicles = vehicles.filter(v => v.available).length;
        const totalCustomers = customers.length;
        const vipCustomers = customers.filter(c => c.status === 'VIP').length;

        const activeRentals = rentals.filter(r => r.status === 'Active').length;
        const confirmedRentals = rentals.filter(r => r.status === 'Confirmed').length;
        const completedRentals = rentals.filter(r => r.status === 'Completed').length;
        const overdueRentals = rentals.filter(r => r.status === 'Overdue').length;

        if (loading) {
          return (
            <div className="app">
              <div className="loading">
                <i className="fas fa-spinner fa-spin"></i> Loading...
              </div>
            </div>
          );
        }

        if (error) {
          return (
            <div className="app">
              <div className="error">
                <i className="fas fa-exclamation-triangle"></i> {error}
                <br />
                <button className="btn refresh-btn" onClick={fetchData}>
                  <i className="fas fa-sync"></i> Retry
                </button>
              </div>
            </div>
          );
        }

        return (
          <div className="app">
            {/* Navigation */}
            <nav className="nav">
              <h1><i className="fas fa-car"></i> Car Rentals Dashboard</h1>
              <div className="nav-links">
                <button 
                  className={`nav-btn ${activeTab === 'dashboard' ? 'active' : ''}`}
                  onClick={() => setActiveTab('dashboard')}
                >
                  <i className="fas fa-tachometer-alt"></i> Dashboard
                </button>
                <button 
                  className={`nav-btn ${activeTab === 'vehicles' ? 'active' : ''}`}
                  onClick={() => setActiveTab('vehicles')}
                >
                  <i className="fas fa-car"></i> Vehicles
                </button>
                <button 
                  className={`nav-btn ${activeTab === 'customers' ? 'active' : ''}`}
                  onClick={() => setActiveTab('customers')}
                >
                  <i className="fas fa-users"></i> Customers
                </button>
                <button 
                  className={`nav-btn ${activeTab === 'rentals' ? 'active' : ''}`}
                  onClick={() => setActiveTab('rentals')}
                >
                  <i className="fas fa-file-contract"></i> Rentals
                </button>
                <button className="btn refresh-btn" onClick={fetchData}>
                  <i className="fas fa-sync"></i> Refresh
                </button>
              </div>
            </nav>

            {/* Dashboard Tab */}
            {activeTab === 'dashboard' && (
              <div>
                <div className="dashboard">
                  <div className="stat-card">
                    <div className="stat-icon blue">
                      <i className="fas fa-car"></i>
                    </div>
                    <div className="stat-content">
                      <h3>{totalVehicles}</h3>
                      <p>Total Vehicles</p>
                    </div>
                  </div>
                  <div className="stat-card">
                    <div className="stat-icon green">
                      <i className="fas fa-check-circle"></i>
                    </div>
                    <div className="stat-content">
                      <h3>{availableVehicles}</h3>
                      <p>Available</p>
                    </div>
                  </div>
                  <div className="stat-card">
                    <div className="stat-icon orange">
                      <i className="fas fa-users"></i>
                    </div>
                    <div className="stat-content">
                      <h3>{totalCustomers}</h3>
                      <p>Total Customers</p>
                    </div>
                  </div>
                  <div className="stat-card">
                    <div className="stat-icon purple">
                      <i className="fas fa-star"></i>
                    </div>
                    <div className="stat-content">
                      <h3>{vipCustomers}</h3>
                      <p>VIP Customers</p>
                    </div>
                  </div>
                </div>

                <div className="dashboard">
                  <div className="stat-card">
                    <div className="stat-icon green">
                      <i className="fas fa-calendar-check"></i>
                    </div>
                    <div className="stat-content">
                      <h3>{activeRentals}</h3>
                      <p>Active Rentals</p>
                    </div>
                  </div>
                  <div className="stat-card">
                    <div className="stat-icon blue">
                      <i className="fas fa-clock"></i>
                    </div>
                    <div className="stat-content">
                      <h3>{confirmedRentals}</h3>
                      <p>Confirmed</p>
                    </div>
                  </div>
                  <div className="stat-card">
                    <div className="stat-icon orange">
                      <i className="fas fa-flag-checkered"></i>
                    </div>
                    <div className="stat-content">
                      <h3>{completedRentals}</h3>
                      <p>Completed</p>
                    </div>
                  </div>
                  <div className="stat-card">
                    <div className="stat-icon purple">
                      <i className="fas fa-exclamation-triangle"></i>
                    </div>
                    <div className="stat-content">
                      <h3>{overdueRentals}</h3>
                      <p>Overdue</p>
                    </div>
                  </div>
                </div>
              </div>
            )}

            {/* Vehicles Tab */}
            {activeTab === 'vehicles' && (
              <div className="section">
                <div className="section-header">
                  <h2 className="section-title">Vehicle Management</h2>
                  <button 
                    className="btn"
                    onClick={() => {
                      setEditingVehicle(null);
                      setShowVehicleModal(true);
                    }}
                  >
                    <i className="fas fa-plus"></i> Add Vehicle
                  </button>
                </div>
                <div className="grid grid-3">
                  {vehicles.map(vehicle => (
                    <div key={vehicle._id} className="card">
                      <div className="vehicle-image">
                        {vehicle.imageUrl ? (
                          <img src={vehicle.imageUrl} alt={vehicle.name} style={{width: '100%', height: '100%', objectFit: 'cover'}} />
                        ) : (
                          <i className="fas fa-car"></i>
                        )}
                      </div>
                      <div className="card-header">
                        <h3>{vehicle.name} ({vehicle.year})</h3>
                        <span className={`badge ${vehicle.available ? 'badge-available' : 'badge-rented'}`}>
                          {vehicle.available ? 'Available' : 'Rented'}
                        </span>
                      </div>
                      <div className="card-body">
                        <div className="detail-grid">
                          <div className="detail-item">
                            <span className="detail-label">Registration</span>
                            <span className="detail-value">{vehicle.registrationNumber}</span>
                          </div>
                          <div className="detail-item">
                            <span className="detail-label">Type</span>
                            <span className="detail-value">{vehicle.type}</span>
                          </div>
                          <div className="detail-item">
                            <span className="detail-label">Fuel</span>
                            <span className="detail-value">{vehicle.fuel}</span>
                          </div>
                          <div className="detail-item">
                            <span className="detail-label">Seats</span>
                            <span className="detail-value">{vehicle.seats}</span>
                          </div>
                        </div>
                        <div className="price">${vehicle.pricePerDay}/day</div>
                        <div className="card-actions">
                          <button 
                            className="btn btn-outline btn-sm"
                            onClick={() => {
                              setEditingVehicle(vehicle);
                              setShowVehicleModal(true);
                            }}
                          >
                            <i className="fas fa-edit"></i> Edit
                          </button>
                          <button 
                            className="btn btn-danger btn-sm"
                            onClick={() => handleDeleteVehicle(vehicle._id)}
                          >
                            <i className="fas fa-trash"></i> Delete
                          </button>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            )}

            {/* Customers Tab */}
            {activeTab === 'customers' && (
              <div className="section">
                <div className="section-header">
                  <h2 className="section-title">Customer Management</h2>
                  <button 
                    className="btn"
                    onClick={() => {
                      setEditingCustomer(null);
                      setShowCustomerModal(true);
                    }}
                  >
                    <i className="fas fa-user-plus"></i> Add Customer
                  </button>
                </div>
                <div className="grid grid-2">
                  {customers.map(customer => (
                    <div key={customer._id} className="card">
                      <div className="card-header">
                        <div>
                          <h3>{customer.name}</h3>
                          <p><i className="fas fa-star"></i> {customer.rating}/5</p>
                        </div>
                        <span className={`badge badge-${customer.status.toLowerCase()}`}>
                          {customer.status}
                        </span>
                      </div>
                      <div className="card-body">
                        <div className="detail-grid">
                          <div className="detail-item">
                            <span className="detail-label">Email</span>
                            <span className="detail-value">{customer.email}</span>
                          </div>
                          <div className="detail-item">
                            <span className="detail-label">Phone</span>
                            <span className="detail-value">{customer.phone}</span>
                          </div>
                          <div className="detail-item">
                            <span className="detail-label">Address</span>
                            <span className="detail-value">{customer.address}</span>
                          </div>
                          <div className="detail-item">
                            <span className="detail-label">Total Rentals</span>
                            <span className="detail-value">{customer.totalRentals || 0}</span>
                          </div>
                        </div>
                        <div className="card-actions">
                          <button 
                            className="btn btn-outline btn-sm"
                            onClick={() => {
                              setEditingCustomer(customer);
                              setShowCustomerModal(true);
                            }}
                          >
                            <i className="fas fa-edit"></i> Edit
                          </button>
                          <button 
                            className="btn btn-danger btn-sm"
                            onClick={() => handleDeleteCustomer(customer._id)}
                          >
                            <i className="fas fa-trash"></i> Delete
                          </button>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            )}

            {/* Rentals Tab */}
            {activeTab === 'rentals' && (
              <div className="section">
                <div className="section-header">
                  <h2 className="section-title">Rental Management</h2>
                  <button 
                    className="btn"
                    onClick={() => setShowRentalModal(true)}
                  >
                    <i className="fas fa-plus"></i> New Booking
                  </button>
                </div>
                <div className="grid grid-2">
                  {rentals.map(rental => (
                    <div key={rental._id} className="card">
                      <div className="card-header">
                        <div>
                          <h3>{rental.vehicle?.name} ({rental.vehicle?.year})</h3>
                          <p>{rental.customer?.name}</p>
                        </div>
                        <span className={`badge badge-${rental.status.toLowerCase()}`}>
                          {rental.status}
                        </span>
                      </div>
                      <div className="card-body">
                        <div className="detail-grid">
                          <div className="detail-item">
                            <span className="detail-label">Start Date</span>
                            <span className="detail-value">
                              {new Date(rental.startDate).toLocaleDateString()}
                            </span>
                          </div>
                          <div className="detail-item">
                            <span className="detail-label">End Date</span>
                            <span className="detail-value">
                              {new Date(rental.endDate).toLocaleDateString()}
                            </span>
                          </div>
                          <div className="detail-item">
                            <span className="detail-label">Daily Rate</span>
                            <span className="detail-value">${rental.dailyRate}</span>
                          </div>
                          <div className="detail-item">
                            <span className="detail-label">Total Amount</span>
                            <span className="detail-value price">${rental.totalAmount}</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            )}

            {/* Modals */}
            <Modal 
              show={showVehicleModal} 
              onClose={() => setShowVehicleModal(false)}
              title={editingVehicle ? 'Edit Vehicle' : 'Add New Vehicle'}
            >
              <VehicleForm
                vehicle={editingVehicle}
                onSave={() => {
                  setShowVehicleModal(false);
                  setEditingVehicle(null);
                  fetchData();
                }}
                onCancel={() => {
                  setShowVehicleModal(false);
                  setEditingVehicle(null);
                }}
              />
            </Modal>

            <Modal 
              show={showCustomerModal} 
              onClose={() => setShowCustomerModal(false)}
              title={editingCustomer ? 'Edit Customer' : 'Add New Customer'}
            >
              <CustomerForm
                customer={editingCustomer}
                onSave={() => {
                  setShowCustomerModal(false);
                  setEditingCustomer(null);
                  fetchData();
                }}
                onCancel={() => {
                  setShowCustomerModal(false);
                  setEditingCustomer(null);
                }}
              />
            </Modal>

            <Modal 
              show={showRentalModal} 
              onClose={() => setShowRentalModal(false)}
              title="Create New Rental"
            >
              <RentalForm
                vehicles={vehicles}
                customers={customers}
                onSave={() => {
                  setShowRentalModal(false);
                  fetchData();
                }}
                onCancel={() => setShowRentalModal(false)}
              />
            </Modal>
          </div>
        );
      }

      ReactDOM.render(<App />, document.getElementById('root'));
    </script>
  </body>
</html>
